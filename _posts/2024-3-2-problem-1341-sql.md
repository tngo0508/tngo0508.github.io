---
layout: single
title: "SQL problem - Movie Rating"
date: 2024-3-02
toc: true
toc_label: "Page Navigation"
toc_sticky: true
show_date: true
tags:
  - SQL
---

## Problem

[![problem-1341](/assets/images/2024-03-02_10-18-28-problem-1341.png)](/assets/images/2024-03-02_10-18-28-problem-1341.png)

Note:

- Use `UNION ALL` to include the the duplicate in case the two sets contain the same string. For example, the user name could be `Rebecca` and movie title could also be `Rebecca`.

## Query

```sql
(
    SELECT
        Users.name AS results
    FROM
        MovieRating,
        Users
    WHERE
        Users.user_id = MovieRating.user_id
    GROUP BY
        Users.user_id
    ORDER BY
        COUNT(MovieRating.movie_id) DESC, Users.name ASC
    LIMIT 1
)

UNION ALL

(
    SELECT
        Movies.title AS results
    FROM
        Movies,
        MovieRating
    WHERE
        Movies.movie_id = MovieRating.movie_id AND
        MONTH(MovieRating.created_at) = 2 AND
        YEAR(MovieRating.created_at) = 2020
    GROUP BY
        Movies.movie_id
    ORDER BY
        AVG(MovieRating.rating) DESC, Movies.title ASC
    LIMIT 1
)
```
